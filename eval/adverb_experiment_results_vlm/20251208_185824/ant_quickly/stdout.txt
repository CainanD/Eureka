[2025-12-08 18:58:29,001][root][INFO] - Workspace: /data/user_data/wenjiel2/Code/roboly/eval/adverb_experiment_results_vlm/20251208_185824/ant_quickly/outputs/eureka/2025-12-08_18-58-28
[2025-12-08 18:58:29,001][root][INFO] - Project Root: /data/user_data/wenjiel2/Code/roboly/Eureka/eureka
[2025-12-08 18:58:29,001][root][INFO] - Using LLM: gpt-4.1-mini
[2025-12-08 18:58:29,001][root][INFO] - Task: Ant
[2025-12-08 18:58:29,001][root][INFO] - Task description: make the ant walk forward quickly
[2025-12-08 18:58:29,001][root][INFO] - Number of reward samples: 2
[2025-12-08 18:58:29,001][root][INFO] - Training mode: individual
[2025-12-08 18:58:29,001][root][INFO] - VLM iterations: 1
[2025-12-08 18:58:29,001][root][INFO] - Loading checkpoint: /data/user_data/wenjiel2/Code/roboly/eval/pretrained_ant_converted.pth
[2025-12-08 18:58:29,024][root][INFO] - 
============================================================
[2025-12-08 18:58:29,024][root][INFO] - Iteration 0/1
[2025-12-08 18:58:29,024][root][INFO] - ============================================================
[2025-12-08 18:58:29,024][root][INFO] - Generating 2 reward functions with gpt-4.1-mini
[2025-12-08 18:58:35,183][httpx][INFO] - HTTP Request: POST https://ai-gateway.andrew.cmu.edu/chat/completions "HTTP/1.1 200 OK"
[2025-12-08 18:58:35,197][root][INFO] - Received 2 reward functions
[2025-12-08 18:58:35,198][root][INFO] - Reward function 0: parsed successfully
[2025-12-08 18:58:35,198][root][INFO] - Reward function 1: parsed successfully
[2025-12-08 18:58:35,198][root][INFO] - Training 2 individual policies
[2025-12-08 18:58:35,198][root][INFO] - Training policy 0/1
[2025-12-08 18:58:47,437][root][INFO] - Iteration 0: Code Run 0 successfully training!
[2025-12-08 18:59:03,906][tensorboard][INFO] - No path found after /data/user_data/wenjiel2/Code/roboly/eval/adverb_experiment_results_vlm/20251208_185824/ant_quickly/outputs/eureka/2025-12-08_18-58-28/policy_iter0_response0/runs/AntGPT-2025-12-08_18-58-39/summaries/events.out.tfevents.1765238323.babel-n5-16
[2025-12-08 18:59:03,907][root][INFO] - Policy 0: Max GPT Reward = 838824705094844416.00
[2025-12-08 18:59:03,907][root][INFO] - Training policy 1/1
[2025-12-08 18:59:14,979][root][INFO] - Iteration 0: Code Run 1 successfully training!
[2025-12-08 18:59:31,100][tensorboard][INFO] - No path found after /data/user_data/wenjiel2/Code/roboly/eval/adverb_experiment_results_vlm/20251208_185824/ant_quickly/outputs/eureka/2025-12-08_18-58-28/policy_iter0_response1/runs/AntGPT-2025-12-08_18-59-08/summaries/events.out.tfevents.1765238351.babel-n5-16
[2025-12-08 18:59:31,100][root][INFO] - Policy 1: Max GPT Reward = inf
[2025-12-08 18:59:35,544][root][INFO] - Processed video for policy 0: /data/user_data/wenjiel2/Code/roboly/eval/adverb_experiment_results_vlm/20251208_185824/ant_quickly/outputs/eureka/2025-12-08_18-58-28/vlm_analysis/iter0_policy0.mp4
[2025-12-08 18:59:38,883][root][INFO] - Processed video for policy 1: /data/user_data/wenjiel2/Code/roboly/eval/adverb_experiment_results_vlm/20251208_185824/ant_quickly/outputs/eureka/2025-12-08_18-58-28/vlm_analysis/iter0_policy1.mp4
[2025-12-08 18:59:38,883][root][INFO] - Getting VLM feedback
[2025-12-08 18:59:38,883][root][INFO] - Gemini selecting best from 2 videos
[2025-12-08 19:00:07,416][root][INFO] - Policy 0 feedback received
[2025-12-08 19:00:34,791][root][INFO] - Policy 1 feedback received
[2025-12-08 19:01:01,998][root][INFO] - Gemini selected policy 1
[2025-12-08 19:01:01,999][root][INFO] - Iteration 0 complete. Best reward: inf
[2025-12-08 19:01:01,999][root][INFO] - 
============================================================
[2025-12-08 19:01:01,999][root][INFO] - Iteration 1/1
[2025-12-08 19:01:01,999][root][INFO] - ============================================================
[2025-12-08 19:01:01,999][root][INFO] - Generating 2 reward functions with gpt-4.1-mini
[2025-12-08 19:01:20,854][httpx][INFO] - HTTP Request: POST https://ai-gateway.andrew.cmu.edu/chat/completions "HTTP/1.1 200 OK"
[2025-12-08 19:01:20,856][root][INFO] - Received 2 reward functions
[2025-12-08 19:01:20,857][root][INFO] - Reward function 0: parsed successfully
[2025-12-08 19:01:20,858][root][INFO] - Reward function 1: parsed successfully
[2025-12-08 19:01:20,858][root][INFO] - Training 2 individual policies
[2025-12-08 19:01:20,858][root][INFO] - Training policy 0/1
[2025-12-08 19:01:31,839][root][INFO] - Iteration 1: Code Run 0 execution error!
[2025-12-08 19:01:33,024][root][ERROR] - Training failed:
Traceback (most recent call last):
  File "/data/user_data/wenjiel2/Code/roboly/Eureka/isaacgymenvs/isaacgymenvs/train.py", line 214, in launch_rlg_hydra
    statistics = runner.run({
  File "/data/user_data/wenjiel2/Code/roboly/Eureka/rl_games/rl_games/torch_runner.py", line 124, in run
    self.run_train(args)
  File "/data/user_data/wenjiel2/Code/roboly/Eureka/rl_games/rl_games/torch_runner.py", line 101, in run_train
    self.agent.train()
  File "/data/user_data/wenjiel2/Code/roboly/Eureka/rl_games/rl_games/common/a2c_common.py", line 1260, in train
    step_time, play_time, update_time, sum_time, a_losses, c_losses, b_losses, entropies, kls, last_lr, lr_mul = self.train_epoch()
  File "/data/user_data/wenjiel2/Code/roboly/Eureka/rl_games/rl_games/common/a2c_common.py", line 1124, in train_epoch
    batch_dict = self.play_steps()
  File "/data/user_data/wenjiel2/Code/roboly/Eureka/rl_games/rl_games/common/a2c_common.py", line 695, in play_steps
    self.obs, rewards, self.dones, infos = self.env_step(res_dict['actions'])
  File "/data/user_data/wenjiel2/Code/roboly/Eureka/rl_games/rl_games/common/a2c_common.py", line 504, in env_step
    obs, rewards, dones, infos = self.vec_env.step(actions)
  File "/data/user_data/wenjiel2/Code/roboly/Eureka/isaacgymenvs/isaacgymenvs/utils/rlgames_utils.py", line 256, in step
    return  self.env.step(actions)
  File "/data/user_data/wenjiel2/miniconda3/envs/eureka/lib/python3.8/site-packages/gym/wrappers/record_video.py", line 86, in step
    observations, rewards, dones, infos = super().step(action)
  File "/data/user_data/wenjiel2/miniconda3/envs/eureka/lib/python3.8/site-packages/gym/core.py", line 280, in step
    return self.env.step(action)
  File "/data/user_data/wenjiel2/Code/roboly/Eureka/isaacgymenvs/isaacgymenvs/tasks/base/vec_task.py", line 377, in step
    self.post_physics_step()
  File "/data/user_data/wenjiel2/Code/roboly/Eureka/isaacgymenvs/isaacgymenvs/tasks/antgpt.py", line 248, in post_physics_step
    self.compute_reward(self.actions)
  File "/data/user_data/wenjiel2/Code/roboly/Eureka/isaacgymenvs/isaacgymenvs/tasks/antgpt.py", line 185, in compute_reward
    self.rew_buf[:], self.rew_dict = compute_reward(self.root_states, self.potentials, self.prev_potentials, self.dof_pos, self.dof_pos_prev, self.up_vec, self.dt)
AttributeError: 'AntGPT' object has no attribute 'dof_pos_prev'

[2025-12-08 19:01:33,024][root][WARNING] - Policy 0: Training failed - training_error
[2025-12-08 19:01:33,024][root][INFO] - Training policy 1/1
[2025-12-08 19:01:43,964][root][INFO] - Iteration 1: Code Run 1 successfully training!
[2025-12-08 19:01:59,933][tensorboard][INFO] - No path found after /data/user_data/wenjiel2/Code/roboly/eval/adverb_experiment_results_vlm/20251208_185824/ant_quickly/outputs/eureka/2025-12-08_18-58-28/policy_iter1_response1/runs/AntGPT-2025-12-08_19-01-37/summaries/events.out.tfevents.1765238500.babel-n5-16
[2025-12-08 19:01:59,933][root][INFO] - Policy 1: Max GPT Reward = inf
[2025-12-08 19:01:59,933][root][INFO] - Iteration 1 complete. Best reward: inf
[2025-12-08 19:01:59,933][root][INFO] - 
============================================================
[2025-12-08 19:01:59,933][root][INFO] - TRAINING COMPLETE
[2025-12-08 19:01:59,933][root][INFO] - ============================================================
[2025-12-08 19:01:59,933][root][INFO] - Best policy: iteration 0, response 1
[2025-12-08 19:01:59,933][root][INFO] - Best GPT reward: inf
[2025-12-08 19:01:59,933][root][INFO] - Policy saved in: policy_iter0_response1
[2025-12-08 19:01:59,934][root][INFO] - Best reward function saved to: /data/user_data/wenjiel2/Code/roboly/Eureka/isaacgymenvs/isaacgymenvs/tasks/antgpt.py
[2025-12-08 19:01:59,934][root][INFO] - Done!

